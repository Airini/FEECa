<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>FEECa - MultiIndex</title>
        <link rel="stylesheet" type="text/css" href="../../../web/css/default.css" />
    </head>
    <body>

      <div style="width: 1200px; align: center" , id="container">
      <div id="menu">
        <h2 class="nav"> FEECa </h2>
        <ul class="main" style="list-style: none;">
        <li><a href="../../../">Home</a></li>
        <li><a href="../../../">Examples</a></li>
        <li> Documentation
            <ul class="menu">
            <li class="menu"><label>FEECa</label><ul class="menu"><li class="menu"><a href="../../../src/FEECa/Bernstein.html">Bernstein.lhs</a></li><li class="menu"><a href="../../../src/FEECa/FiniteElementSpace.html">FiniteElementSpace.lhs</a></li><li class="menu"><label>Internal</label><ul class="menu"><li class="menu"><a href="../../../src/FEECa/Internal/MultiIndex.html">MultiIndex.lhs</a></li><li class="menu"><a href="../../../src/FEECa/Internal/Point.html">Point.lhs</a></li><li class="menu"><a href="../../../src/FEECa/Internal/Simplex.html">Simplex.lhs</a></li><li class="menu"><a href="../../../src/FEECa/Internal/Vector.html">Vector.lhs</a></li></ul></li><li class="menu"><a href="../../../src/FEECa/Polynomial.html">Polynomial.lhs</a></li><li class="menu"><a href="../../../src/FEECa/PolynomialDifferentialForm.html">PolynomialDifferentialForm.lhs</a></li><li class="menu"><label>Utility</label><ul class="menu"><li class="menu"><a href="../../../src/FEECa/Utility/Combinatorics.html">Combinatorics.lhs</a></li></ul></li></ul></li>
            </ul>
        </li>
        </ul>
       </div>

      <div id="main">
        <div id="content">

            <p><span>-# LANGUAGE TemplateHaskell #-</span></p>
<h1 id="multi-indices">Multi-Indices</h1>
<p>The <code>MultiIndex</code> module provides a data type and functions for handling of multi-indices. A multi-index <span class="math inline">\(\boldsymbol{\alpha}\)</span> is a tuple</p>
<p><span class="math display">\[\begin{aligned}
  \boldsymbol{\alpha} &amp;= (\alpha_0,\ldots,\alpha_{n-1}), \quad \alpha_i \in \mathrm{N}_0^+\end{aligned}\]</span></p>
<p>that generalized the notion of an exponent for vectors in <span class="math inline">\(\mathbb{R}^{n}\)</span>. The power of a vector <span class="math inline">\(\boldsymbol{x}^{\boldsymbol{\alpha}}\)</span> is defined as</p>
<p><span class="math display">\[\begin{aligned}
  \boldsymbol{x}^{\boldsymbol{\alpha}} &amp;= \prod_{i = 0}^{n-1} x_i^{\alpha_i}\end{aligned}\]</span> The degree of a multi-index <span class="math inline">\(\boldsymbol{\alpha}\)</span> is the sum of exponents in the tuple:</p>
<p><span class="math display">\[\begin{aligned}
  |\boldsymbol{\alpha}| &amp;= \sum_{i=0}^{n-1} \alpha_i\end{aligned}\]</span></p>
<p>The support <span class="math inline">\(\text{supp} \left \{ \boldsymbol{\alpha} \right \}\)</span> of a multi-index <span class="math inline">\(\boldsymbol{\alpha}\)</span> is defined as the set of indices <span class="math inline">\(i\)</span> for which the exponents <span class="math inline">\(\alpha_i\)</span> are non-zero:</p>
<p><span class="math display">\[\begin{aligned}
 \text{supp}\left \{ \boldsymbol{\alpha} \right \}  &amp;= \{ i \in [0,n-1] ~|~ \alpha_i &gt; 0 \}\end{aligned}\]</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" title="1"></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="ot">{-# LANGUAGE TypeSynonymInstances #-}</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="ot">{-# LANGUAGE StandaloneDeriving   #-}</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="ot">{-# LANGUAGE FlexibleInstances    #-}</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">-- {-# LANGUAGE DeriveFoldable       #-}</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="ot">{-# LANGUAGE CPP                  #-}</span></a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">module</span> <span class="dt">FEECa.Internal.MultiIndex</span> (</a>
<a class="sourceLine" id="cb1-9" title="9"></a>
<a class="sourceLine" id="cb1-10" title="10">  <span class="co">-- * The MultiIndex type</span></a>
<a class="sourceLine" id="cb1-11" title="11">    <span class="dt">MultiIndex</span>, toList, valid</a>
<a class="sourceLine" id="cb1-12" title="12"></a>
<a class="sourceLine" id="cb1-13" title="13">  <span class="co">-- ** Constructors</span></a>
<a class="sourceLine" id="cb1-14" title="14">  , multiIndex, zero, unit, degreeR</a>
<a class="sourceLine" id="cb1-15" title="15"></a>
<a class="sourceLine" id="cb1-16" title="16">  <span class="co">-- * Extension and Restriction</span></a>
<a class="sourceLine" id="cb1-17" title="17">  , extend, is_in_range, restrict</a>
<a class="sourceLine" id="cb1-18" title="18"></a>
<a class="sourceLine" id="cb1-19" title="19">  <span class="co">-- * Mathematical Operations</span></a>
<a class="sourceLine" id="cb1-20" title="20">  , add, decrease, derive, factorial, choose, choose', degree, <span class="fu">range</span></a>
<a class="sourceLine" id="cb1-21" title="21"></a>
<a class="sourceLine" id="cb1-22" title="22">  ) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-23" title="23"></a>
<a class="sourceLine" id="cb1-24" title="24"></a>
<a class="sourceLine" id="cb1-25" title="25"><span class="kw">import</span>            <span class="dt">Control.Applicative</span>               (<span class="dt">ZipList</span>(..), liftA2, pure, (&lt;*&gt;))</a>
<a class="sourceLine" id="cb1-26" title="26"><span class="co">{-</span></a>
<a class="sourceLine" id="cb1-27" title="27"><span class="co">  #if MIN_VERSION_base(4,9,0)</span></a>
<a class="sourceLine" id="cb1-28" title="28"><span class="co">  #else</span></a>
<a class="sourceLine" id="cb1-29" title="29"><span class="co">  import            Data.Foldable                     (Foldable(..))</span></a>
<a class="sourceLine" id="cb1-30" title="30"><span class="co">  #endif</span></a>
<a class="sourceLine" id="cb1-31" title="31"><span class="co">-}</span></a>
<a class="sourceLine" id="cb1-32" title="32"></a>
<a class="sourceLine" id="cb1-33" title="33"><span class="kw">import</span>            <span class="dt">FEECa.Utility.Combinatorics</span>       (sumRLists)</a>
<a class="sourceLine" id="cb1-34" title="34"><span class="kw">import</span> <span class="kw">qualified</span>  <span class="dt">FEECa.Utility.Combinatorics</span> <span class="kw">as</span> <span class="dt">C</span>  (choose, factorial)</a>
<a class="sourceLine" id="cb1-35" title="35"><span class="kw">import</span>            <span class="dt">FEECa.Internal.Spaces</span>             (<span class="dt">Dimensioned</span>(..), <span class="dt">Field</span>(..))</a>
<a class="sourceLine" id="cb1-36" title="36"></a>
<a class="sourceLine" id="cb1-37" title="37"></a></code></pre></div>
<h2 id="the-multiindex-type">The <code>MultiIndex</code> type</h2>
<p>The <code>MultiIndex</code> type is implemented as a type synomnym for <code>ZipList Int</code> type because this allows the use of the <code>Applicative</code> class for the implementation of methods on multi-indices.</p>
<p>The dimension of a multi-index is the dimension of the underlying space, i.e. the number of exponents in the multi-index.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" title="1"></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">type</span> <span class="dt">MultiIndex</span> <span class="ot">=</span> <span class="dt">ZipList</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">-- #if MIN_VERSION_base(4,9,0)</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">-- #else</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">-- deriving instance Foldable ZipList</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="pp">#if MIN_VERSION_base(4,7,0)</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="pp">#else</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="kw">deriving</span> <span class="kw">instance</span> <span class="dt">Show</span> <span class="dt">MultiIndex</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="kw">deriving</span> <span class="kw">instance</span> <span class="dt">Eq</span>   <span class="dt">MultiIndex</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="pp">#endif</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">-- #endif</span></a>
<a class="sourceLine" id="cb2-13" title="13"></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="kw">instance</span> <span class="dt">Dimensioned</span> <span class="dt">MultiIndex</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-15" title="15">  dim mi <span class="ot">=</span> <span class="fu">length</span> (getZipList mi)</a></code></pre></div>
<p>The functions <code>degree</code> and <code>range</code> compute the degree and range of a given multi-index, as defined above.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" title="1"></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">-- | Degree of a multi-index, i.e. the sum of all indices</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="ot">degree ::</span> <span class="dt">Integral</span> a <span class="ot">=&gt;</span> <span class="dt">MultiIndex</span> <span class="ot">-&gt;</span> a</a>
<a class="sourceLine" id="cb3-4" title="4">degree <span class="ot">=</span> <span class="fu">fromIntegral</span> <span class="op">.</span> <span class="fu">sum</span> <span class="op">.</span> getZipList</a>
<a class="sourceLine" id="cb3-5" title="5"></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">-- | List indices of the multi-index that are non-zero.</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="fu">range</span><span class="ot"> ::</span> <span class="dt">MultiIndex</span> <span class="ot">-&gt;</span> [<span class="dt">Int</span>]</a>
<a class="sourceLine" id="cb3-8" title="8"><span class="fu">range</span> <span class="ot">=</span> range' <span class="dv">0</span></a>
<a class="sourceLine" id="cb3-9" title="9"></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="ot">range' ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">MultiIndex</span> <span class="ot">-&gt;</span> [<span class="dt">Int</span>]</a>
<a class="sourceLine" id="cb3-11" title="11">range' i (<span class="dt">ZipList</span> (l<span class="op">:</span>ls))</a>
<a class="sourceLine" id="cb3-12" title="12">      <span class="op">|</span> l <span class="op">/=</span> <span class="dv">0</span>    <span class="ot">=</span> i <span class="op">:</span> range' (i<span class="op">+</span><span class="dv">1</span>) (<span class="dt">ZipList</span> ls)</a>
<a class="sourceLine" id="cb3-13" title="13">      <span class="op">|</span> <span class="fu">otherwise</span> <span class="ot">=</span>     range' (i<span class="op">+</span><span class="dv">1</span>) (<span class="dt">ZipList</span> ls)</a>
<a class="sourceLine" id="cb3-14" title="14">range' _ (<span class="dt">ZipList</span> []) <span class="ot">=</span> []</a></code></pre></div>
<h3 id="constructors">Constructors</h3>
<p>The <code>MultiIndex</code> type provides the <code>multiIndex</code> constructor which constructs a multi-index from a list of integers <code>[Int]</code>. The constructor makes sure that all entries of the multi-index are positive and throws a run-time error otherwise.</p>
<p>The <code>toList</code> function transforms a given multi-index back to a list <code>[a]</code> of <code>Integer</code> class type.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" title="1"><span class="co">-- | Create a multi-index from a given list of integers.</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="ot">multiIndex ::</span> [<span class="dt">Int</span>] <span class="ot">-&gt;</span> <span class="dt">MultiIndex</span></a>
<a class="sourceLine" id="cb4-3" title="3">multiIndex l</a>
<a class="sourceLine" id="cb4-4" title="4">    <span class="op">|</span> valid mi  <span class="ot">=</span> mi</a>
<a class="sourceLine" id="cb4-5" title="5">    <span class="op">|</span> <span class="fu">otherwise</span> <span class="ot">=</span> <span class="fu">error</span> <span class="st">&quot;multiIndex: Multi-index is invalid!&quot;</span></a>
<a class="sourceLine" id="cb4-6" title="6">  <span class="kw">where</span> mi <span class="ot">=</span> <span class="dt">ZipList</span> l</a>
<a class="sourceLine" id="cb4-7" title="7"></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">-- | Check whether a given multi-index is valid.</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="ot">valid ::</span> <span class="dt">MultiIndex</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb4-10" title="10">valid <span class="ot">=</span> <span class="fu">all</span> (<span class="op">&gt;=</span> <span class="dv">0</span>) <span class="op">.</span> getZipList</a>
<a class="sourceLine" id="cb4-11" title="11"></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">-- | Transform multi-index into list</span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="ot">toList ::</span> <span class="co">{-Integral a =&gt;-}</span> <span class="dt">MultiIndex</span> <span class="ot">-&gt;</span> [<span class="dt">Int</span>]</a>
<a class="sourceLine" id="cb4-14" title="14">toList <span class="ot">=</span> <span class="co">{-map fromIntegral .-}</span> getZipList</a></code></pre></div>
<p>A common use case is the creation of multi-indices of degree 0 or 1. This is done using the functions <code>zero</code> and <code>unit</code>, respectively. The function <code>zero</code> creates a multi-index of given dimension containing only zeros, while <code>unit</code> creates a multi-index of given dimension with all elements equal to zero except for the element with index <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[\begin{aligned}
  (a_0,\ldots,a_{n-1}) \text{ with }
  \alpha_0,\ldots,\alpha_{i-1},\alpha_{i+1},\ldots,\alpha_{n-1} = 0
  \text{ and } \alpha_i = 1\end{aligned}\]</span></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" title="1"></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">-- | Degree zero multi-index</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="ot">zero ::</span><span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">MultiIndex</span></a>
<a class="sourceLine" id="cb5-4" title="4">zero n <span class="ot">=</span> <span class="dt">ZipList</span> (<span class="fu">replicate</span> n <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb5-5" title="5"></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">-- | Degree one multi-index of dimension n with i-th element equal to one and</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">-- | all others zero.</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="ot">unit ::</span> <span class="dt">Int</span> <span class="co">-- n</span></a>
<a class="sourceLine" id="cb5-9" title="9">     <span class="ot">-&gt;</span> <span class="dt">Int</span> <span class="co">-- i</span></a>
<a class="sourceLine" id="cb5-10" title="10">     <span class="ot">-&gt;</span> <span class="dt">MultiIndex</span></a>
<a class="sourceLine" id="cb5-11" title="11">unit n i <span class="ot">=</span> <span class="dt">ZipList</span> <span class="op">$</span> <span class="fu">concat</span> [<span class="fu">replicate</span> i <span class="dv">0</span>,[<span class="dv">1</span>],<span class="fu">replicate</span> (n<span class="op">-</span>i<span class="op">-</span><span class="dv">1</span>) <span class="dv">0</span>]</a></code></pre></div>
<p>The function <code>degreeR</code> returns a list of all multi-indices of given dimension <span class="math inline">\(n\)</span> and degree <span class="math inline">\(r\)</span>. It is basically a wrapper for the <code>sumRLists</code> function provided by the <code>FEECa.Utility.Combinatorics</code> module.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><a class="sourceLine" id="cb6-1" title="1"></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">-- | List of all dimension n (length n + 1) multi-indices of degree r</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="ot">degreeR ::</span> <span class="dt">Integral</span> a <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> [<span class="dt">MultiIndex</span>]</a>
<a class="sourceLine" id="cb6-4" title="4">degreeR n r <span class="ot">=</span> <span class="fu">map</span> <span class="dt">ZipList</span> <span class="op">$</span> sumRLists (<span class="fu">fromIntegral</span> n) (<span class="fu">fromIntegral</span> r)</a></code></pre></div>
<h2 id="sec:mi_extension">Extension of Multi-Indices</h2>
<p>For the extension of polynomials from a sub-simplex <span class="math inline">\(\mathcal{f} =
[\boldsymbol{v_{i_0}},\ldots,\boldsymbol{v_{i_k}}]\)</span> to a super-simplex <span class="math inline">\(\mathcal{T} =
[\boldsymbol{v_{0}},\ldots,\boldsymbol{v_{m}}]\)</span> it is necessary to also extend the multi-indices from <span class="math inline">\(\mathcal{f}\)</span> to <span class="math inline">\(\mathcal{T}\)</span>. To this end we assume that the face of dimension <span class="math inline">\(k\)</span> is given by a mapping <span class="math inline">\(\sigma(j) = i_j\)</span> that encodes which vertices of the super-simplex <span class="math inline">\(\mathcal{T}\)</span> are included in <span class="math inline">\(\mathcal{f}\)</span>. Note that <span class="math inline">\(m\)</span> is not necessarily the dimension of the underlying Euclidean space <span class="math inline">\(\mathbb{R}^{n}\)</span>. Each element <span class="math inline">\(\alpha_i\)</span> in a multi-index <span class="math inline">\(\boldsymbol{\alpha} =
(\alpha_0,\ldots,\alpha_k)\)</span> defined over the face <span class="math inline">\(\mathcal{f}\)</span> represents a power of the barycentric coordinate corresponding to the vertex <span class="math inline">\(\boldsymbol{v_i}\)</span>. The extended multi-index <span class="math inline">\(\boldsymbol{\alpha'}\)</span> is then zero in all positions corresponding to vertices of <span class="math inline">\(\mathcal{T}\)</span> that are not included in <span class="math inline">\(\mathcal{f}\)</span> and coincides with <span class="math inline">\(\boldsymbol{\alpha}\)</span> on positions corresponding to the same vertices. The extended multi-index <span class="math inline">\(\boldsymbol{\alpha'} =
({\alpha'_0,\ldots,\alpha'_m})\)</span> is thus given by</p>
<p><span class="math display">\[\begin{aligned}
  \alpha'_j &amp;= \begin{cases}
    \alpha_i &amp; \text{, if } \sigma(i) = j \\
    0 &amp; \text{otherwise}
    \end{cases}\end{aligned}\]</span></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><a class="sourceLine" id="cb7-1" title="1"></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">-- | Extend a multi-index from a face to a simplex.</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="ot">extend ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> [<span class="dt">Int</span>] <span class="ot">-&gt;</span> <span class="dt">MultiIndex</span> <span class="ot">-&gt;</span> <span class="dt">MultiIndex</span></a>
<a class="sourceLine" id="cb7-4" title="4">extend n sigma mi</a>
<a class="sourceLine" id="cb7-5" title="5">    <span class="op">|</span> <span class="fu">length</span> sigma <span class="op">==</span> dim mi <span class="ot">=</span> multiIndex <span class="op">$</span> extend' n (<span class="op">-</span><span class="dv">1</span>) sigma mi'</a>
<a class="sourceLine" id="cb7-6" title="6">    <span class="op">|</span> <span class="fu">otherwise</span> <span class="ot">=</span> <span class="fu">error</span> <span class="op">$</span>(<span class="fu">show</span> sigma) <span class="op">++</span> <span class="st">&quot; \n &quot;</span> <span class="op">++</span> <span class="fu">show</span> mi <span class="op">++</span> <span class="st">&quot;extend: Dimensions of sigma and multi-index don't agree&quot;</span></a>
<a class="sourceLine" id="cb7-7" title="7">  <span class="kw">where</span> mi' <span class="ot">=</span> getZipList mi</a>
<a class="sourceLine" id="cb7-8" title="8"></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="ot">extend' ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> [<span class="dt">Int</span>] <span class="ot">-&gt;</span> [<span class="dt">Int</span>] <span class="ot">-&gt;</span> [<span class="dt">Int</span>]</a>
<a class="sourceLine" id="cb7-10" title="10">extend' n _ []      []      <span class="ot">=</span> <span class="fu">replicate</span> n <span class="dv">0</span></a>
<a class="sourceLine" id="cb7-11" title="11">extend' n i (s<span class="op">:</span>ss)  (j<span class="op">:</span>js)  <span class="ot">=</span> <span class="fu">replicate</span> di <span class="dv">0</span> <span class="op">++</span> (j <span class="op">:</span> extend' (n <span class="op">-</span> di <span class="op">-</span> <span class="dv">1</span>) s ss js)</a>
<a class="sourceLine" id="cb7-12" title="12">  <span class="kw">where</span> di <span class="ot">=</span> s <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span>  <span class="co">-- Number of zeros to pad.</span></a>
<a class="sourceLine" id="cb7-13" title="13">extend' _ _ _       _       <span class="ot">=</span> <span class="fu">error</span> <span class="st">&quot;extend': list argument lengths must match&quot;</span></a>
<a class="sourceLine" id="cb7-14" title="14"></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="ot">is_in_range ::</span> [<span class="dt">Int</span>] <span class="ot">-&gt;</span> <span class="dt">MultiIndex</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb7-16" title="16">is_in_range sigma mi <span class="ot">=</span> is_in_range' sigma (toList mi)</a>
<a class="sourceLine" id="cb7-17" title="17"></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="ot">is_in_range' ::</span> [<span class="dt">Int</span>] <span class="ot">-&gt;</span> [<span class="dt">Int</span>] <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb7-19" title="19">is_in_range' [] is <span class="ot">=</span> <span class="fu">all</span> (<span class="dv">0</span><span class="op">==</span>) is</a>
<a class="sourceLine" id="cb7-20" title="20">is_in_range' sigma<span class="op">@</span>(s<span class="op">:</span>ss) (i<span class="op">:</span>is)</a>
<a class="sourceLine" id="cb7-21" title="21">  <span class="op">|</span> s <span class="op">&gt;</span> <span class="dv">0</span>  <span class="ot">=</span> (i <span class="op">==</span> <span class="dv">0</span>) <span class="op">&amp;&amp;</span> (is_in_range' sigma' is)</a>
<a class="sourceLine" id="cb7-22" title="22">  <span class="op">|</span> s <span class="op">==</span> <span class="dv">0</span> <span class="ot">=</span> is_in_range' ss' is</a>
<a class="sourceLine" id="cb7-23" title="23">  <span class="kw">where</span> sigma' <span class="ot">=</span> <span class="fu">map</span> ((<span class="op">+</span>) (<span class="op">-</span><span class="dv">1</span>)) sigma</a>
<a class="sourceLine" id="cb7-24" title="24">        ss'    <span class="ot">=</span> <span class="fu">map</span> ((<span class="op">+</span>) (<span class="op">-</span><span class="dv">1</span>)) ss</a>
<a class="sourceLine" id="cb7-25" title="25"></a>
<a class="sourceLine" id="cb7-26" title="26"><span class="ot">restrict ::</span> [<span class="dt">Int</span>] <span class="ot">-&gt;</span> <span class="dt">MultiIndex</span> <span class="ot">-&gt;</span> <span class="dt">MultiIndex</span></a>
<a class="sourceLine" id="cb7-27" title="27">restrict sigma mi <span class="ot">=</span> multiIndex <span class="op">$</span> restrict' sigma (toList mi)</a>
<a class="sourceLine" id="cb7-28" title="28"></a>
<a class="sourceLine" id="cb7-29" title="29"><span class="ot">restrict' ::</span> [<span class="dt">Int</span>] <span class="ot">-&gt;</span> [<span class="dt">Int</span>] <span class="ot">-&gt;</span> [<span class="dt">Int</span>]</a>
<a class="sourceLine" id="cb7-30" title="30">restrict' [] _ <span class="ot">=</span> []</a>
<a class="sourceLine" id="cb7-31" title="31">restrict' sigma<span class="op">@</span>(s<span class="op">:</span>ss) (i<span class="op">:</span>is)</a>
<a class="sourceLine" id="cb7-32" title="32">  <span class="op">|</span> s <span class="op">&gt;</span> <span class="dv">0</span>  <span class="ot">=</span> restrict' sigma' is</a>
<a class="sourceLine" id="cb7-33" title="33">  <span class="op">|</span> s <span class="op">==</span> <span class="dv">0</span> <span class="ot">=</span> i <span class="op">:</span> restrict' ss' is</a>
<a class="sourceLine" id="cb7-34" title="34">  <span class="kw">where</span> sigma' <span class="ot">=</span> <span class="fu">map</span> ((<span class="op">+</span>) (<span class="op">-</span><span class="dv">1</span>)) sigma</a>
<a class="sourceLine" id="cb7-35" title="35">        ss'    <span class="ot">=</span> <span class="fu">map</span> ((<span class="op">+</span>) (<span class="op">-</span><span class="dv">1</span>)) ss</a></code></pre></div>
<h2 id="mathematical-operations">Mathematical Operations</h2>
<h3 id="addition">Addition</h3>
<p>Addition on multi-indices is defined in a straight-foward manner as the addition of the each pair of elements separately.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><a class="sourceLine" id="cb8-1" title="1"></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">-- | Add two multi-indices</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="ot">add ::</span> <span class="dt">Integral</span> a <span class="ot">=&gt;</span> <span class="dt">ZipList</span> a <span class="ot">-&gt;</span> <span class="dt">ZipList</span> a <span class="ot">-&gt;</span> <span class="dt">ZipList</span> a</a>
<a class="sourceLine" id="cb8-4" title="4">add <span class="ot">=</span> liftA2 (<span class="op">+</span>)</a></code></pre></div>
<h3 id="factorial">Factorial</h3>
<p>The factorial of a multi-index is defined as the product of the factorial of all its elements:</p>
<p><span class="math display">\[\begin{aligned}
  \boldsymbol{\alpha}! &amp;= \prod_{i=0}^{n-1} \alpha_i!\end{aligned}\]</span></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><a class="sourceLine" id="cb9-1" title="1"></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co">-- | Generalized factorial for multi-indices</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="ot">factorial ::</span> <span class="dt">Num</span> b <span class="ot">=&gt;</span> <span class="dt">MultiIndex</span> <span class="ot">-&gt;</span> b</a>
<a class="sourceLine" id="cb9-4" title="4">factorial <span class="ot">=</span> <span class="fu">product</span> <span class="op">.</span> <span class="fu">map</span> C.factorial <span class="op">.</span> toList</a></code></pre></div>
<h3 id="binomial-coefficient">Binomial Coefficient</h3>
<p>The binomial coefficient of two multi-index is defined as the product of the element-wise binomial coefficients.</p>
<p><span class="math display">\[\begin{aligned}
  \boldsymbol{\alpha} \choose \boldsymbol{\beta} &amp;= \prod_{i=0}^{n-1} {\alpha_i \choose \beta_i}\end{aligned}\]</span></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><a class="sourceLine" id="cb10-1" title="1"></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co">-- | Generalized binomial coefficients for multi-indices as defined in the paper</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">-- | by Kirby.</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="ot">choose ::</span> (<span class="dt">Integral</span> a, <span class="dt">Num</span> b) <span class="ot">=&gt;</span> <span class="dt">ZipList</span> a <span class="ot">-&gt;</span> <span class="dt">ZipList</span> a <span class="ot">-&gt;</span> b</a>
<a class="sourceLine" id="cb10-5" title="5">choose a b <span class="ot">=</span> <span class="fu">product</span> (getZipList <span class="op">$</span> liftA2 C.choose a b)</a>
<a class="sourceLine" id="cb10-6" title="6"></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="ot">choose' ::</span> <span class="dt">Fractional</span> b <span class="ot">=&gt;</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">MultiIndex</span> <span class="ot">-&gt;</span> b</a>
<a class="sourceLine" id="cb10-8" title="8">choose' a b <span class="ot">=</span> C.factorial a <span class="op">/</span> factorial b <span class="co">-- fromIntegral (C.factorial a) / fromIntegral (factorial b)</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">-- TODO: investigate *why* fromIntegral was there before.</span></a></code></pre></div>
<h3 id="derivation">Derivation</h3>
<p>For the derivation of polynomials, it is required to decrease the element at a given index of a multi-index, this is implemented by the <code>decrease</code> function.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><a class="sourceLine" id="cb11-1" title="1"><span class="co">-- | Decrease element in multi-index</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="ot">decrease ::</span> <span class="dt">Integral</span> a <span class="ot">=&gt;</span>  <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">ZipList</span> a <span class="ot">-&gt;</span> <span class="dt">ZipList</span> a</a>
<a class="sourceLine" id="cb11-3" title="3">decrease i alpha  <span class="ot">=</span> <span class="fu">pure</span> f <span class="op">&lt;*&gt;</span> <span class="dt">ZipList</span> [<span class="dv">0</span><span class="op">..</span>] <span class="op">&lt;*&gt;</span> alpha</a>
<a class="sourceLine" id="cb11-4" title="4">  <span class="kw">where</span> f j a <span class="ot">=</span> <span class="kw">if</span> j <span class="op">==</span> i <span class="kw">then</span> <span class="fu">max</span> <span class="dv">0</span> (a<span class="op">-</span><span class="dv">1</span>) <span class="kw">else</span> a</a>
<a class="sourceLine" id="cb11-5" title="5"></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">-- | Decrease element in multi-index</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="ot">derive ::</span> (<span class="dt">Integral</span> a, <span class="dt">Field</span> b) <span class="ot">=&gt;</span>  <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">ZipList</span> a <span class="ot">-&gt;</span> (b, <span class="dt">ZipList</span> a)</a>
<a class="sourceLine" id="cb11-8" title="8">derive i alpha  <span class="ot">=</span> (c, decrease i alpha)</a>
<a class="sourceLine" id="cb11-9" title="9">  <span class="kw">where</span> c <span class="ot">=</span> (<span class="fu">fromDouble</span> <span class="op">.</span> <span class="fu">fromIntegral</span>) (getZipList alpha <span class="op">!!</span> i)</a></code></pre></div>

        </div>
        <div id="footer">
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>
      </div>
      </div>

    </body>
</html>
